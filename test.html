<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Final Solution - "Boldy" Edition</title>
    <style>
        /* --- Basic Page Setup --- */
        body {
            font-family: 'Roboto Mono', monospace;
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 2rem;
            font-size: 1.5rem;
            line-height: 2;
        }
        h1, h2, p {
            max-width: 900px;
            margin: 1rem auto;
        }
        h1 { color: #3498db; }
        h2 { border-bottom: 2px solid #34495e; padding-bottom: 0.5rem; margin-top: 3rem; }
        code { background-color: #34495e; padding: 2px 5px; border-radius: 3px; }

        /* --- FINAL PRODUCTION STYLES --- */
        .text-container {
            background-color: #34495e;
            padding: 10px;
            border-radius: 5px;
            max-width: 900px;
            margin: 1rem auto;
            display: flex;
            flex-wrap: wrap;
        }
        .text-container span {
            position: relative;
            white-space: pre-wrap;
        }
        .text-container .default { color: #7f8c8d; }
        .text-container .correct { color: #2ecc71; }
        .text-container .incorrect { color: #e74c3c; }
        .text-container .newline-break { flex-basis: 100%; height: 0; }
        .selected {
            color: #2c3e50;
            background-image: linear-gradient(
                transparent 20%, #3498db 20%, 
                #3498db 80%, transparent 80%
            );
            background-repeat: no-repeat;
        }
        .underline::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 3px;
            background-color: #e74c3c;
            left: 0;
            bottom: 9px;
        }
        .selection-start { border-top-left-radius: 3px; border-bottom-left-radius: 3px; }
        .selection-end { border-top-right-radius: 3px; border-bottom-right-radius: 3px; }
    </style>
</head>
<body>

    <h1>The Final Solution: With "Boldy" Text</h1>
    <p>Using a subtle <code>text-shadow</code> to give the font a heavier, more substantial feel without using <code>font-weight: bold</code>.</p>

    <h2>Edge Case 1: Selection Overlapping an Underline</h2>
    <div class="text-container" id="example1"></div>

    <h2>Edge Case 2: Multi-line Selection</h2>
    <div class="text-container" id="example2"></div>

    <h2>Edge Case 3: Multi-line Underline</h2>
    <div class="text-container" id="example3"></div>


    <script>
        class VisualDebugger {
            constructor(containerId, text) { this.container = document.getElementById(containerId); this.text = text; this.charSpans = []; this.init(); }
            init() { this.container.innerHTML = ''; this.charSpans = []; for (const char of this.text) { if (char === '\n') { const br = document.createElement('div'); br.className = 'newline-break'; this.container.appendChild(br); this.charSpans.push(null); } else { const span = document.createElement('span'); span.innerText = char; span.className = 'default'; this.container.appendChild(span); this.charSpans.push(span); } } }
            applyStyles(styles) { for (const style of styles) { const { start, end, className } = style; if (start >= end) continue; for (let i = start; i < end; i++) { if (this.charSpans[i]) { this.charSpans[i].classList.add(className); } } if (className === 'selected') { if (this.charSpans[start]) this.charSpans[start].classList.add('selection-start'); if (this.charSpans[end - 1]) this.charSpans[end - 1].classList.add('selection-end'); } } }
        }
        const text1 = "This text has an error, and we will select it.";
        const demo1 = new VisualDebugger('example1', text1);
        demo1.applyStyles([ { start: 17, end: 22, className: 'incorrect' }, { start: 17, end: 22, className: 'underline' }, { start: 12, end: 32, className: 'selected' } ]);
        const text2 = "This is a long line of text that is designed to wrap onto multiple lines to demonstrate the selection.";
        const demo2 = new VisualDebugger('example2', text2);
        demo2.applyStyles([ { start: 10, end: 80, className: 'correct' }, { start: 10, end: 80, className: 'selected' } ]);
        const text3 = "Here is some text with a very long incorrect section that will also wrap across multiple lines.";
        const demo3 = new VisualDebugger('example3', text3);
        demo3.applyStyles([ { start: 26, end: 85, className: 'incorrect' }, { start: 26, end: 85, className: 'underline' } ]);
    </script>

</body>
</html>